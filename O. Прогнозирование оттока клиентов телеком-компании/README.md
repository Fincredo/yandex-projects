# Прогнозирование оттока клиентов телеком-компании

_Финальный проект_


## Задача проекта

На основе персональных данных о некоторых клиентах оператора связи и информации об их тарифах и договорах, построить модель для прогноза оттока клиентов и его своевременного предотвращения.


## Описание проекта

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия.  
Для исследования предоставлены персональные данные о некоторых клиентах, информация об их тарифах и договорах.  
Оператор предоставляет два основных типа услуг: стационарную телефонную связь и интернет, а также дополнительные услуги (антивирус и блокировка небезопасных сайтов, выделенная линия техподдержки, облачное хранилище файлов, стриминговое телевидение и каталог фильмов).  
Клиенты могут оплачивать услуги каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.


## Этапы работы

1.  Изучение данных:
    - таблица "contract";
    - таблица "personal";
    - таблица "internet";
    - таблица "phone".
2.  Предобработка данных:
    - объединение таблиц и переименование столбцов;
    - добавление столбцов и изменение типов данных;
    - обработка пропусков.
3.  Исследовательский анализ данных:
    - анализ количественных признаков;
    - анализ категориальных признаков.
4.  Подготовка признаков для обучения моделей:
    - выделение признаков и целевого признака;
    - разбивка датасетов на обучающую и тестовую выборки;
    - кодирование значений категориальных признаков;
    - масштабирование признаков и борьба с дисбалансом классов.
5.  Создание и обучение моделей:
    - LogisticRegression;
    - RandomForestClassifier;
    - LGBMClassifier;
    - CatBoostClassifier.
6.  Тестирование и исследование результатов:
    - тестирование лучшей модели;
    - проверка модели на вменяемость;
    - дополнительные исследования.
7.  Отчет об исследовании:
    - итоги исследования;
    - выводы и рекомендации.


## Результат

1. Созданы 4 модели машинного обучения: LogisticRegression, RandomForestClassifier и две бустинговые - LGBMClassifier и CatBoostClassifier. Модели обучены через кросс-валидацию. 
2. CatBoostClassifier лидировал по большинству метрик. Модель обучена на предварительно масштабированных признаках и проверена на тестовой выборке. При этом использован поиск оптимального порогового значения вероятности для дальнейшего расчета метрик и выведены графики ROC-кривой и кривой Precision-Recall.
3. В результате исследования отобранная и протестированная модель CatBoostClassifier продемонстрировала высокое качество, значение метрики AUC-ROC составило 0.9364. 
4. Помимо AUC-ROC, получено 4 группы метрик, в каждой из которых одна из них: Accuracy, Precision, Recall или F1-score - имела свое максимально возможное значение в установленных границах порога вероятности. Кроме того, в каждой группе получены соответствующие матрицы ошибок. При лучшем пороге для Accuracy ее значение составило 0.8976, для Precision - 0.8806, для Recall - 0.8697, для F1-score - 0.7914. Т.о. у оператора связи есть 4 стратегии при максимизации той или иной метрики, либо их различных комбинациях.
5. Анализ сочетаний метрик при разных порогах классификации, показал, что существует кривая зависимости минимально допустимой прибыли в результате удержания каждого абонента (FP/(TP-FN)) от количества абонентов, упущенных вследствие наличия ложно-отрицательных прогнозов (FN). Данная кривая поможет оператору связи принимать правильные решения после получения предсказаний модели. Зная примерно значение дохода с каждого потенциально удержанного абонента, с учетом себестоимости услуг, и заложив минимально приемлемую прибыль, финансовое управление компании может рассчитать оптимальный рекламный бюджет и выбрать нужную стратегию поведения.


## Библиотеки и методы

- Python
- pandas
- numpy
- seaborn
- matplotlib
- sklearn
- catboost
- lightgbm
- OHE
- Градиентный бустинг
