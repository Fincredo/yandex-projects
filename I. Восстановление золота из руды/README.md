# Восстановление золота из руды

_Сборный проект 2_


## Задача проекта

Подготовить прототип модели машинного обучения для предсказания коэффициента восстановления золота из золотосодержащей руды, на основе данных с параметрами его добычи и очистки.


## Описание проекта

Добывающей компании «ГлавРосГосНефть» предстоит определить место для бурения новой скважины.  
Для исследования предоставлены пробы нефти в трех регионах, с известными характеристиками месторождений в каждом из них: качество нефти, а также объем её запасов.  
Необходимо построить модель для предсказания объема запасов в новых скважинах и определения региона, где добыча принесет наибольшую прибыль. 
Для этого требуется выбрать месторождения с самыми высокими оценками значений запасов и определить регион с максимальной суммарной прибылью отобранных скважин.



## Этапы работы

1.  Подготовка данных:
    - открытие и изучение файлов (общие сведения, статистики, дубликаты, корреляции);
    - анализ отсутствующих признаков;
    - проверка эффективности обогащения;
    - предобработка данных (пропуски, целевые признаки, нули, лишние признаки).
2.  Анализ данных:
    - изменение концентрации металлов (Au, Ag, Pb) на различных этапах;
    - сравнение распределения размеров гранул сырья на обучающей и тестовой выборках;
    - исследование суммарной концентрации всех веществ на разных стадиях.
3.  Модель:
    - подготовка;
    - обучение и проверка.
4.  Итоги исследования и выводы.


## Результат

1. Для обучения были выбраны модели линейной регресси. Средние значения предсказанного запаса сырья в регионах "A" и "C" составили 92,6 и 95 тас. баррелей, соответственно, их RMSE - 37,6 и 40 тыс. баррелей, а R2 - 0.28 и 0.21, соответственно, что свидетельствует о низком качестве предсказаний модели.
2. В регионе "B" результаты прогноза следующие: среднее оказалось меньше - 68.7 баррелей, но при этом RMSE и R2 - гораздо лучше - менее 1 тыс. баррелей и 0.999, соответственно.
3. Рассчитан средний бюджет на разработку одной скважины - 50 млн. руб. - минимальниый доход для достижения безубыточности. Минимальный объем нефти, которую должна давать скважина для покрытия расходов на ее разработку, составил 111 тыс. баррелей. 
4. Полученные с помощью техники Bootstrap распределения из 1000 слуйчано собранных выборок показали следующие результаты по средней прибыли:
    - Регион "A" - 396 млн. руб., при этом потенциальные убытки - 111 млн. рублей. (с вероятностью 6.9%);
    - Регион "B" - 456 млн. руб., потенциальные убытки - 34 млн. рублей. (с вероятностью 1.5%);
    - Регион "C" - 404 млн. руб., потенциальные убытки - 163 млн. руб. (с вероятностью - 7.6%).
5. Выбор был сделан в пользу региона "B", где риск убытков минимален. В остальных двух регионах, как показывает прогноз, с указанным доверительным интервалом в 95%, убытки неизбежны. 


## Библиотеки и методы

- Python
- pandas
- numpy
- seaborn
- matplotlib
- sklearn
- math
- sMAPE
- Кросс-валидация
